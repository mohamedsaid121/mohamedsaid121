{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook, sheetName: string, in_sourceColumns: string[], in_data: string [][]) {\n\n    console.log(\"script 2 received\");\n    console.log(\"type of in_sourcecolumns\", typeof in_sourceColumns);\n    console.log(\"in_sourcecolumns:\", JSON.stringify(in_sourceColumns));\n    console.log(\"type of in_data\", typeof in_data);\n    console.log(\"in_data:\", JSON.stringify(in_data));\n\n    let sheet = workbook.getWorksheet(sheetName);\n    if (!sheet){\n        console.log(`sheet \"${sheetName}\" not found`);\n        return;\n    }\n\n    const columnMapping: {[key: string]: string} = {\n        'Staff ID':'Staff ID',\n        'Full Name':'Emp Name',\n        'Number of Sick Days':'Number of Sick Days',\n        'Diagnosis':'Original Diagnose',\n        'SHW Feedback':'Diagnose'\n    };\n\n    let table = sheet.getTables()[0];\n    if(!table){\n        console.log('No table found in the destination sheet');\n        return;\n    }\n\n    in_sourceColumns.map((sourceColumnName, index) => {\n\n        let trimmedSourceColumn = sourceColumnName.trim()\n        let destinationColumnName = columnMapping[trimmedSourceColumn];\n\n        if(!destinationColumnName){\n            console.log(`No mapping for \"${trimmedSourceColumn}\"`)\n            return;\n        }\n\n        if(!in_data[index] || in_data[index].length == 0){\n            console.log(`No data for \"${trimmedSourceColumn}\"`);\n            return;\n        }\n\n        let column = table.getColumnByName(destinationColumnName);\n        if (column){\n            let startRow = column.getRangeBetweenHeaderAndTotal().getRowCount();\n            let dataRange: (string | number | boolean)[][] = in_data[index].map(value => [value]);\n\n            column.getRangeBetweenHeaderAndTotal()\n                .getCell(startRow, 0)\n                .getResizedRange(dataRange.length -1, 0)\n                .setValues(dataRange);\n\n            console.log(`${dataRange.length} rows have been written to ${destinationColumnName}`); \n        }\n    });\n    return {\n        message: \"Data appended successfully\"\n    };\n}\n","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"sheetName\",\"index\":0},{\"name\":\"in_sourceColumns\",\"index\":1},{\"name\":\"in_data\",\"index\":2}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"sheetName\",\"in_sourceColumns\",\"in_data\"],\"properties\":{\"sheetName\":{\"type\":\"string\"},\"in_sourceColumns\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}},\"in_data\":{\"type\":\"array\",\"items\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}}}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"object\",\"properties\":{\"message\":{\"type\":\"string\"}}}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"sheetName\",\"comment\":\"\"},{\"name\":\"in_sourceColumns\",\"comment\":\"\"},{\"name\":\"in_data\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}