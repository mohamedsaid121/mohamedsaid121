{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook, sheetName: string): string {\n    const sourceFileName = workbook.getName().replace(/\\.xlsx$/i, \"\");\n    const SourceColumns = [\n        \"Staff ID\",\n        \"Full Name\",\n        \"Number of Sick Days\",\n        \"Diagnosis\",\n        \"SHW Feedback \"\n    ];\n\n    let sheet = workbook.getWorksheet(sheetName);\n    if (!sheet){\n        console.log(`sheet ${sheetName} not found`);\n        return;\n    }\n\n    let usedRange = sheet.getUsedRange();\n    if (!usedRange) {\n        console.log(`No data found in ${sheetName}`);\n        return;\n    }\n\n    let table = sheet.getTables()[0];\n    if(!table){\n        console.log(`data is Not in table format`);\n        table = sheet.addTable(usedRange.getAddress(), true);\n    }\n\n    let rawData = usedRange.getValues() as string[][];\n    let headers = rawData[0].map(header => header.trim().toLowerCase());\n    let trimmedSourceColumnNames = SourceColumns.map(colName => colName.trim().toLowerCase());\n\n    // columns indices in excel file\n    const columnIndices = trimmedSourceColumnNames.map(colName =>\n        headers.findIndex(header => header === colName)\n    );\n    \n\n    let filteredData = rawData.slice(1)\n                              .filter(row => row.every(cell =>\n        cell !== \"\" || cell !== null || cell !== undefined\n    ));\n\n    let extractedData = filteredData.map(row =>\n        columnIndices.map(index => index !== -1 ? row[index]: \"\")\n    );\n\n    const result = {\n        sourceFileName: sourceFileName,\n        sourceColumns: SourceColumns,\n        data: extractedData\n    };\n\n    return JSON.stringify(result);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"sheetName\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"sheetName\"],\"properties\":{\"sheetName\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"sheetName\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}