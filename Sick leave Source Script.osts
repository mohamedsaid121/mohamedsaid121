{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook, sheetName: string) {\n    let sheet = workbook.getWorksheet(sheetName);\n\n    if (!sheet){\n        console.log(`sheet \"${sheetName}\" not found`);\n        return null;\n    }\n    let table = sheet.getTables()[0];\n    const sourceColumns = ['Staff ID', 'Full Name', 'Number of Sick Days', 'Diagnosis', 'SHW Feedback '];\n\n    if (!table)\n    {\n        let usedRange = sheet.getUsedRange();\n\n        if(!usedRange){\n            console.log(\"No data found in sheet\");\n            return null;\n        }\n        //let UsedRangeWithoutSheet = usedRange.split('!')[1];\n        //console.log(usedRange);\n\n        table = sheet.addTable(usedRange.getAddress(), true);\n    }\n\n    let columnsData: (string | number | boolean)[][] = sourceColumns.map(columnName => {\n        try {\n            let column = table.getColumnByName(columnName);\n            if (column){\n                let data: (string | number | boolean)[][] = column.getRangeBetweenHeaderAndTotal().getValues();\n                return data.map(row => row[0]);\n            } \n            else\n            {\n                console.log(`column \"${columnName}\" not found`);\n                return [];\n            }\n\n        }catch (error) {\n            console.log(`error find column \"${columnName}\" : ${error}`);\n            return [];\n        }\n        \n    });\n\n    return {\n        sourceColumns: sourceColumns,\n        data: columnsData\n    };\n\n}\n","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"sheetName\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"sheetName\"],\"properties\":{\"sheetName\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{}}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"sheetName\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}